<h1 id="decision-trees">Decision Trees</h1>

<p><strong><em>Disclaimer:</em></strong> <em>In the post, I have used NASA astronaut recruitment procedure for the example. I donâ€™t have any experience in it and do not work for NASA. ( At least not yet ðŸ™‚ ). The example is based on the information available here:</em> <a href="https://www.nasa.gov/audience/forstudents/postsecondary/features/F_Astronaut_Requirements.html">https://www.nasa.gov/audience/forstudents/postsecondary/features/F_Astronaut_Requirements.html</a>, <a href="https://www.space.com/25786-how-to-become-an-astronaut.html">https://www.space.com/25786-how-to-become-an-astronaut.html</a></p>

<h2 id="what-are-decision-trees">What are Decision Trees?</h2>

<p>Suppose you work for NASA and have to select the next batch of astronauts. You receive 20,000 applications from aspiring candidates. However, before you manually go through each, you need to keep only those that meet the criteria. The agency has strict requirements on experience, height and education.</p>

<p>Now, suppose that the following are the first 10 applications you receive:</p>

<p><img src="/img/wp-content/uploads/2018/09/Untitled-9f81c606-71ff-4416-9479-fcd2832ce442.png" alt="" /></p>

<p>Based on this you can clearly take decisions whether to consider the application for further review. Here clearly, the non-US citizens do not qualify. Further, applicants with less than 3 years of experience also do not meet the agency requirements.</p>

<p>This is where decision trees can come in handy. A decision tree for the above data can be as follows. Further, this is just one variant of a decision tree that can be formed.</p>

<p><img src="/img/wp-content/uploads/2018/09/Untitled-5ca65293-008c-44ed-a2f3-975dd81efd8b.png" alt="" /></p>

<p>As you can see, decision trees visually and explicitly represent decisions. Here, the internal nodes represent conditions on which the branch splits and the leaf node represents the decision.</p>

<p>Now, this was just an example. In reality, you can expect a more complicated tree with more decision nodes. However, the principle is the same.</p>

<p><strong>Decision Trees in Machine Learning.</strong> There are two types of predictions which a machine learning model makes; Classification and Regression.</p>

<p><strong>Classification</strong> deals with assigning classes. That is, in the above example, to tell whether to consider or reject the candidateâ€™s application.</p>

<p><strong>Regression</strong> deals with continuous values. Suppose you are given the speed of a car and you want to predict the distance it travels after the brake is applied.</p>

<p>Decision trees can be used for both the tasks and thus, leads to two categories of trees; Classification tree and Regression tree.</p>

<h2 id="how-to-make-one">How to make one?</h2>

<p>Now that you have an idea of what a decision tree is, the next question that comes is, <em>how do you build one?</em></p>

<p>Consider the data is represented in a 2D space:</p>

<p><img src="/img/wp-content/uploads/2018/09/Untitled-fb87fd44-64ba-438e-b3d5-2dc82a5b6dea.png" alt="" /></p>

<p>Here, we would like to split the space into regions so as to correctly classify the data points.</p>

<p>This can be done as follows:</p>

<p><img src="/img/wp-content/uploads/2018/09/Untitled-df796c21-0422-415d-9b60-550bb92e507b.png" alt="" /></p>

<p>The blue lines represent the threshold of the split in x<sub>1</sub> and x<sub>2</sub>.</p>

<p>In order to achieve this split automatically, we need to calculate the cost of each split. The split with the lowest cost is chosen. The aim of this is to find the most homogeneous branch. Which means that a group having the most similar features. The splitting is applied in recursion until some stopping criterion is met. This criterion can be either, the minimum number of training points on the leaf of the tree or limitation on the depth of the tree. This ensures that the tree does not overfit.</p>

<h2 id="show-me-the-code">Show me the code</h2>

<p>Following is the code for making a decision tree using Scikit-Learn in python.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">le</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>

<span class="n">training</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">"yes"</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="s">"accept"</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s">"yes"</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="s">"accept"</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">"yes"</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="s">"reject"</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="s">"yes"</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="s">"reject"</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">"no"</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="s">"reject"</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="s">"no"</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="s">"reject"</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">"yes"</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="s">"reject"</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">"yes"</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="s">"accept"</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s">"yes"</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="s">"accept"</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">"no"</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="s">"reject"</span><span class="p">],</span>
<span class="p">])</span>

<span class="n">training</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">training</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> 


<span class="n">X</span> <span class="o">=</span> <span class="n">training</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">training</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># test data
</span><span class="n">test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">"yes"</span><span class="p">,</span> <span class="mi">63</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">"no"</span><span class="p">,</span> <span class="mi">59</span><span class="p">],</span>
    <span class="p">])</span>
<span class="n">test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">))</span>
</code></pre></div></div>

<p>Predicted output:</p>

<p>[â€˜acceptâ€™ â€˜rejectâ€™]</p>

<p>You can grab the code <a href="https://github.com/ashwinvaidya17/DecisionTree-ScikitLearn">here</a>.</p>
